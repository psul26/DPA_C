(C) COPYRIGHT 2009 Korea University C.I.S.T (Center For Information Security Technologies)
Author : Hae-Il Jung. - 20/08/2009 - jung-haeil@korea.ac.kr



We also provide some implementation result.
This file describes a new kind of side-channel attack (Build-in Determined Sub-key Composition Multi-DPA).
 

This document consists in five parts as follows

 1. Introduction.

 2. Analytical Techniques.

 3. How to run the script function on BS-CM DPA.
 
 4. File descriptions (including source files).

 5. Results


1. Introduction

  (1) Development Environment

   Microsoft Visual Studio 2008 on Windows Vista 64 bit

  (2) Attack Side
   
   Ciphertext side 

  (3) Technique

   Signal preprocessing, BS-CM DPA, 

  (4) File Order

   Database file order 



 2. Analytical Techniques

  (1) Signal preprocessing

   
   We select six points from 14486 to 14491, and then compress 3 points to one point by evaluating mean of 3 points
   
 
  (2) BS-CM DPA (Build-in Determined Sub-key Composition Multi-DPA)

 
   For more efficient analysis, we combine the advantage of two methods: Multi-DPA [1999] and Sum of Mono-big DPA [2003].

   [1999]  Multi-bit DPA, by Thomas S. MESSERGES et al., "Investigations of Power Analysis Attacks on Smartcards". 
   [2003]  Sum of Mono-bit DPA, by  R. Bevan, E. Knudsen et al., "Ways to Enhance Differential Power Analysis"
   
   Both methods can find the sub-key of DES algorithm by analyzing differential traces for classified traces.
   
   In Multi-bit DPA method, differential trace is evaluated in terms of hamming weight.

   For Sum of Mono-bit DPA method, differential trace is evaluated  in terms of each S-box output bit.

   In both methods, some useful information related with the sub-key is resolved in differential traces.

   Our idea is to use both methods for obtaining much more useful information than using only one method.

   Also, we utilize the information, related to the sub-key, obtained from the Multi-DPA. (See [2009] for detail.)

   [2009] Yuichi Komano and Hideo Shimizu and Shinichi Kawamura, "Build-in Determined Sub-key Correlation Power Analysis, " eprint 2009/161
   

   Accordingly, Our method is to composite A method, B method and C method(accumulated hamming weight as in [2009]).
	
   A Method : [1999] Multi-bit DPA
   B Method : [2003] Sum of Mono-bit DPA
   C Method : [2009] we use accumulated hamming weight as in [2009]
   

   % T_A: differential trace generated by method A (we use C method : accumulated hamming weight as in [2009])
   % T_B1: differential trace generated by method B according to the 1st bit of S-box
   % T_B2: differential trace generated by method B according to the 2nd bit of S-box
   % T_B3: differential trace generated by method B according to the 3rd bit of S-box
   % T_B4: differential trace generated by method B according to the 4th bit of S-box
   %
   % We derive a decision trace T_N from two differential traces T_A and T_B by computing "0.5*T_A+0.125*T_B1+0.125*T_B2+0.125*T_B3+0.125*T_B4= 1*T_N(All information of key)".
   



 3. How to run the script function on BS-CM DPA

  * The main function is executed as follows:


    1) Execute 'preprocess' function
       - Select some useful points (14486 ~ 14491), 
       - Compress the points (from 3 points to one point)
       
    2) Execute 'read' function
       - Read cipher-text from database_order.txt
   
    3) Execute 'make_target' function
       - Generate output data of target-sbox.
      
    4) Execute 'classification_hw' function
       - Classify input traces by hamming weight of target-sbox output. 
        (In our method, we use accumulated hamming weight method described in [2009].)
       - Execute the 'dif_value' function for generating differential trace
        (The 'dif_value' function generates differential trace for two set of traces.)
    
    5) Execute 'classification_bit' function 
       - Classify input traces by each 1-bit of target-sbox output 
       - Execute the 'dif_value' function for generating differential trace
        (The 'dif_value' function generates differential trace for two set of traces.)

    6) Generate decision trace 
       - Generate a decision trace by summing two differential traces generated in Step 4 and Step 5.

    7) Find Key
       - Choose a key which causes the maximum peak

    8) Verify Key 
       - If the key found in Step 7 is not correct, go to Step 3 with +1 traces.    
   


 4. File description


  ¡Ø  All file should be stored in the same folder 


  README.txt : this file

  output.txt : result of BS-CM DPA attack
   
  database_order.txt : cipher text with fixed order
   
  preprocess.c : select points and compress them

  make_target.c : generate target-bit and target-hamming weight (By input cipher text, key guess )
   
  main.c : BS-CM DPA


  proprecess.h : header-file dedicated to preprocess
   
  make_target.h :  header-file dedicated to generation of target

  ref.h :  header-file dedicated to reference of program



 5. Result

  We can find all sub-keys using 208 trace.

